:8000 {
    root * /srv/dist

    # Handle /apps/learning-resources routes (from proxy)
    @app_match {
        path /apps/learning-resources*
    }
    handle @app_match {
        uri strip_prefix /apps/learning-resources
        file_server
    }

    # Handle /learning-resources routes
    @learning_resources_match {
        path /learning-resources /learning-resources/
    }
    handle @learning_resources_match {
        uri strip_prefix /learning-resources
        rewrite / /index.html
        file_server
    }

    @learning_resources_subpath {
        path /learning-resources/*
    }
    handle @learning_resources_subpath {
        uri strip_prefix /learning-resources
        file_server
    }

    # Default handler for root
    handle / {
        try_files {path} /index.html
        file_server
    }
}
